
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="RESTful API around Antenna House Formatter application for converting manuscript XML tagged according to JATS to PDF.">
      
      
        <meta name="author" content="Andrey Kolotev">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>API - JATS2PDF</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="JATS2PDF" class="md-header__button md-logo" aria-label="JATS2PDF" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JATS2PDF
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://bitbucket.ncbi.nlm.nih.gov/projects/PMC/repos/jats2pdf/browse/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Bitbucket
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="JATS2PDF" class="md-nav__button md-logo" aria-label="JATS2PDF" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    JATS2PDF
  </label>
  
    <div class="md-nav__source">
      <a href="https://bitbucket.ncbi.nlm.nih.gov/projects/PMC/repos/jats2pdf/browse/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Bitbucket
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="0README.html" class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="1README-API.html" class="md-nav__link md-nav__link--active">
        API
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-interactions" class="md-nav__link">
    API Interactions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deposit" class="md-nav__link">
    Deposit
  </a>
  
    <nav class="md-nav" aria-label="Deposit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deposit-model" class="md-nav__link">
    Deposit Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-actions" class="md-nav__link">
    Deposit Actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-items" class="md-nav__link">
    URL items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-items" class="md-nav__link">
    File Items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-items" class="md-nav__link">
    Mixed items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-items" class="md-nav__link">
    No items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-commit" class="md-nav__link">
    Deposit commit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-state-monitoring" class="md-nav__link">
    Deposit state monitoring
  </a>
  
    <nav class="md-nav" aria-label="Deposit state monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#state-no_result" class="md-nav__link">
    State NO_RESULT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-result_is_ready" class="md-nav__link">
    State RESULT_IS_READY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-expired" class="md-nav__link">
    State EXPIRED
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-waiting_for_upload" class="md-nav__link">
    State WAITING_FOR_UPLOAD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-states-diagram" class="md-nav__link">
    Deposit states diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-is-ready" class="md-nav__link">
    Deposit is ready
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversion-failed" class="md-nav__link">
    Conversion failed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#item" class="md-nav__link">
    Item
  </a>
  
    <nav class="md-nav" aria-label="Item">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#item-model" class="md-nav__link">
    Item model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#item-states-diagram" class="md-nav__link">
    Item states diagram
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-generated-diagram" class="md-nav__link">
    Auto-generated diagram
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="2README-API-USE-EXAMPLES.html" class="md-nav__link">
        Use examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="3BACKOFFICE.html" class="md-nav__link">
        Back-Office
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="4CHANGELOG.html" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-interactions" class="md-nav__link">
    API Interactions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deposit" class="md-nav__link">
    Deposit
  </a>
  
    <nav class="md-nav" aria-label="Deposit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deposit-model" class="md-nav__link">
    Deposit Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-actions" class="md-nav__link">
    Deposit Actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-items" class="md-nav__link">
    URL items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-items" class="md-nav__link">
    File Items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-items" class="md-nav__link">
    Mixed items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-items" class="md-nav__link">
    No items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-commit" class="md-nav__link">
    Deposit commit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-state-monitoring" class="md-nav__link">
    Deposit state monitoring
  </a>
  
    <nav class="md-nav" aria-label="Deposit state monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#state-no_result" class="md-nav__link">
    State NO_RESULT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-result_is_ready" class="md-nav__link">
    State RESULT_IS_READY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-expired" class="md-nav__link">
    State EXPIRED
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-waiting_for_upload" class="md-nav__link">
    State WAITING_FOR_UPLOAD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-states-diagram" class="md-nav__link">
    Deposit states diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-is-ready" class="md-nav__link">
    Deposit is ready
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversion-failed" class="md-nav__link">
    Conversion failed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#item" class="md-nav__link">
    Item
  </a>
  
    <nav class="md-nav" aria-label="Item">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#item-model" class="md-nav__link">
    Item model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#item-states-diagram" class="md-nav__link">
    Item states diagram
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-generated-diagram" class="md-nav__link">
    Auto-generated diagram
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h1>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>For each article, the service requires:</p>
<ol>
<li>
<p>An article XML file that is well-formed and valid according to the NLM
Journal Publishing or Archiving DTD version 2.3 or 3.0 or to the NISO
JATSJournal Publishing or Archiving DTD version 1.0 or 1.1.</p>
</li>
<li>
<p>Images referenced in the article XML file must be supplied in TIFF format
with ".tif" extension (although the image references in the graphic/@xlink:href
might not include the file extension).</p>
</li>
<li>
<p>Also, the PMC known domain name may be supplied for output styling/branding.
If a domain name is not supplied within an XML, a general HHS style will be used.
If you need the output to be styled differently from what currently supported,
please make an inquiry.</p>
</li>
<li>
<p>A <code>domain</code> the article belongs to. (Branding and rendering could be specific
for each domain.). If the <code>domain</code> of your interest is not supported yet, then contact PMC group.</p>
</li>
<li>
<p>Depositor name.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, the implementation supports branding/styling based on XML PIs:</p>
<p><div class="highlight"><pre><span></span><code><span class="nt">&lt;article&gt;</span>
    <span class="cp">&lt;?domain ...?&gt;</span>
<span class="nt">&lt;/article&gt;</span>
</code></pre></div>
or
<div class="highlight"><pre><span></span><code><span class="nt">&lt;article&gt;</span>
    <span class="cp">&lt;?origin ...?&gt;</span>
<span class="nt">&lt;/article&gt;</span>
</code></pre></div>
If they both are missing the generic HHS branding will be applied.
In the future the domain supplied with your request
to create a <code>deposit</code> will take precedece over above PIs.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PMC conversion group needs to investigate if images other than the tiffs
are currently expected in XSL code.</p>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The production API endpoint is available at
<a href="https://api.ncbi.nlm.nih.gov/lit/jats2pdf/api/">https://api.ncbi.nlm.nih.gov/lit/jats2pdf/api/</a>.</p>
<p>Also, there is a starting/home page of the service available at
<a href="https://dev.ncbi.nlm.nih.gov/lit/jats2pdf/">https://dev.ncbi.nlm.nih.gov/lit/jats2pdf/</a>.</p>
<p>Other links:</p>
<ul>
<li><a href="https://api.ncbi.nlm.nih.gov/lit/jats2pdf/swagger/">API Swagger page</a></li>
<li><a href="https://api.ncbi.nlm.nih.gov/lit/jats2pdf/swagger/?format=openapi">API Swagger OpenApi specs</a></li>
<li><a href="https://api.ncbi.nlm.nih.gov/lit/jats2pdf/redoc/">API Redoc page</a></li>
<li><a href="https://api.ncbi.nlm.nih.gov/lit/jats2pdf/admin/">Admin page</a>.</li>
<li><a href="https://api.ncbi.nlm.nih.gov/lit/jats2pdf/version/">Check the version of application</a></li>
</ul>
<p>The following entities of the API are available for consumers:</p>
<ul>
<li>depositors -&gt; /api/depositors/</li>
<li>domains -&gt; /api/domains/</li>
<li>deposits -&gt; /api/deposits/</li>
<li>items -&gt; /api/deposits/{<code>deposit_pk</code>}/items/</li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This service currently supports interactive requests with the browser
of your choice and with your custom application, which sends
and accepts data in <code>JSON</code> format.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is highly suggested to read a useful details
on <a href="https://www.restapitutorial.com/lessons/httpmethods.html">HTTP verbs</a> and on <a href="https://www.restapitutorial.com/httpstatuscodes.html">HTTP response codes</a> suitable for this API.</p>
</div>
<h2 id="definitions">Definitions<a class="headerlink" href="#definitions" title="Permanent link">&para;</a></h2>
<div class="admonition detail">
<p class="admonition-title">Detail</p>
<ul>
<li>
<p><code>depositor</code> - the consumer of this web service (later,
a login from credentials will be used instead),
currently used for self-identification.</p>
</li>
<li>
<p><code>domain</code> - the name to be used in the future for manuscript branding
and processes applied by the <strong>jats2pdf-back-office</strong> scripts. Currently,
the PI &lt;?domain ...?&gt; or &lt;?origin ...?&gt; from XML itself is used for that.
But you have to provide this property in your requests
for future compatibility.</p>
</li>
<li>
<p><code>deposit</code> - set of files (aka <strong>items</strong>) to be used in conversion.
All files in deposit must have unique names.
Only one manuscript XML file must be present.
All other files expected are images for figures,
tables (if no native tables available), equations if applicable.
The <strong>deposit</strong> could be provided as a single
or multiple archive file(s) (in .zip, .tar, .tar.gz or .tgz formats)
which includes an XML file with all image files it depends on
Or as uncompressed/unarchived individual files.
Each file of the deposit is called an <strong>item</strong>,
see definition of <strong>item</strong> below.</p>
</li>
<li>
<p><code>item</code> - is an entity of this service which represents a file (name)
or URL behind a file. All <strong>items</strong> together constitute a <strong>deposit</strong>
to be used in the conversion process to PDF document.</p>
</li>
<li>
<p><code>deposit_pk</code> - the service generated identifier of a <strong>deposit</strong>
(also called as <strong>deposit_id</strong>).</p>
</li>
<li>
<p><code>item_pk</code> - the service generated identifier of an <strong>item</strong>
(also called as <strong>item_id</strong>).</p>
</li>
</ul>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>When an <strong>item</strong> is a file, it has to be uploaded to NCBI's S3
storage bucket by consumer separately. When an <strong>item</strong> is an URL
starting with "http://" or "https://" sub-strings then
the <strong>jats2pdf-back-office</strong> component must be able to access
files behind the URLs from storage of consumer's choice.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Files compressed with various utilities
(producing .tar, .bz2,  .tar.bz2, .tgz, .zip,
.7z, .tar.Z, .rar formats) are <del>not</del> supported <del>yet</del>.</p>
</div>
<h2 id="api-interactions">API Interactions<a class="headerlink" href="#api-interactions" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to receive and send your data in json format use the following
headers: <code>Content-Type: application/json</code> and <code>Accept: application/json</code> in
your HTTP requests.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can also point your browser to all endpoints of this service.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not all forms work properly, unfortunately.</p>
</div>
<p>The following steps (in plain words) could be considered as a typical scenario
to interact with a service.</p>
<div class="admonition detail">
<p class="admonition-title">Detail</p>
<ul>
<li><a href="#deposit">Create a deposit</a>.</li>
<li>Upload items to NCBI's S3 storage bucket if you can not provide URL of your files.</li>
<li><a href="#deposit-commit">Commit a deposit</a>.</li>
<li><a href="#deposit-state-monitoring">Monitor a deposit state</a></li>
<li><a href="#deposit-result">Fetch a result</a> if generated.</li>
</ul>
</div>
<p>The service supports many other actions, but they are not considered typical
for the consumers.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Error handling on the client side expected to correspond
to <a href="https://www.restapitutorial.com/httpstatuscodes.html">HTTP response codes</a>.
The content you may see in HTTP body in <code>JSON</code> or other formats
may be useful during development of your client.
Possibly the <code>details</code> property from the response body
could be useful if delivered.
It could be sometime cryptic for end-user to interpret
the source of the problem.</p>
</div>
<h2 id="deposit">Deposit<a class="headerlink" href="#deposit" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Create</p>
<div class="highlight"><pre><span></span><code>POST /api/deposits
</code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To create a deposit you need to send a <code>POST</code> request to <code>/api/deposits/</code>
endpoint. Based on your desire and ability to provide your files inform
of URLs or files, you may proceed to one of the following sections
<a href="#url-items">URL items</a>, <a href="#file-items">File items</a>, <a href="#mixed-items">Mixed items</a>
or even with <a href="#no-items">No items</a> (do not worry you can supply items later
in subsequent requests).</p>
</div>
<h3 id="deposit-model">Deposit Model<a class="headerlink" href="#deposit-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>{
  action: string,
  items: [
    $item, $item, ...
  ],
  details: string,
  *depositor*: string,
  *domain*: string,
  #deposit_id#: string,
  #created#: iso-8601-time-date-string,
  #updated#: iso-8601-time-date-string,
  #state#: string,
}
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Properties in the model above, enclosed into <code>*</code> (asterisks) are mandatory,
enclosed into <code>#</code> are read-only and should be in your requests.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="#item-model">details of an <code>$item</code></a> in your requests below.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Details</p>
<ul>
<li><code>action</code> - a property to indicate the desirable action applied to the <strong>deposit</strong></li>
<li><code>deposit_id</code> - a deposit unique identifier.</li>
<li><code>depositor</code> - see explanations in <a href="#definitions">Definitions</a> section.</li>
<li><code>domain</code> - see explanations in <a href="#definitions">Definitions</a> section.</li>
<li><code>state</code> - a machine-readable deposit state, see <a href="#deposit-states-diagram">diagram</a>.</li>
<li><code>created</code> - time of creation of the deposit.</li>
<li><code>updated</code> - time of the last update of the deposit.</li>
<li><code>items</code> - an array of deposit items, see explanations of item in
<a href="#definitions">Definitions</a> section.</li>
</ul>
</div>
<h3 id="deposit-actions">Deposit Actions<a class="headerlink" href="#deposit-actions" title="Permanent link">&para;</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>the following actions could be used as values of <code>action</code> property
in <a href="#deposit-model">deposit model</a> or could be used with <code>PUT</code> requests
to the endpoints <code>/api/deposits/{deposit_pk}/{action}/</code></p>
</div>
<div class="admonition details">
<p class="admonition-title">Details</p>
<ul>
<li><code>commit</code> - commit a <strong>deposit</strong> for processing.</li>
<li><code>retry</code> - reprocess a <code>deposit</code> if possible.</li>
<li><code>started</code> - mark a <strong>deposit</strong> to be waiting for result.</li>
<li><code>no_result</code> - mark a <strong>deposit</strong> as failed one with no result.</li>
<li><code>succeeded</code> - mark a <strong>deposit</strong> as successful.</li>
<li><code>expire</code> - mark a <strong>deposit</strong> as expired.</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Action value <code>commit</code> would make sense
at the time of the new <code>deposit</code> creation for URL items.
Not all actions are possible at a given state,
see <a href="#deposit-states-diagram">Deposit states diagram</a> below
to understand the possible transitions.</p>
</div>
<h3 id="url-items">URL items<a class="headerlink" href="#url-items" title="Permanent link">&para;</a></h3>
<p>You can use the following model for your requests.
See <a href="2README-API-USE-EXAMPLES.html#deposit-url-items">an example</a> of such
request on a separate page.</p>
<div class="highlight"><pre><span></span><code>{
  action: string,
  items: [
    $item, $item, ...
  ],
  *depositor*: string,
  *domain*: string,
}
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When you supply your <code>deposit</code> to the service with URL(s) it is recommended
to prepare and make available your file(s) ahead of time,
that you can use <code>action</code> property with value "commit"
to initiate processing of your deposit at the time of your request
when you create a deposit.</p>
</div>
<h3 id="file-items">File Items<a class="headerlink" href="#file-items" title="Permanent link">&para;</a></h3>
<p>You can use the following model for your requests.
See <a href="2README-API-USE-EXAMPLES.html#deposit-file-items">an example</a> of such
request on a separate page.</p>
<div class="highlight"><pre><span></span><code>{
  items: [
    $item, $item, ...
  ],
  *depositor*: string,
  *domain*: string
}
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When you supply your <code>deposit</code> to the service with File(s) in response you will
get <code>s3_put_url</code> property for each item, which you have to use within 1 hour to
upload your files to NCBI's S3 storage bucket with HTTP <code>PUT</code> requests. Here is
an example of using curl: <code>curl "${s3_put_url}" --upload-file an_article.xml</code>,
<code>curl "${s3_put_url}" --upload-file an_image1.tif</code>, ...;</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Just in case if s3_put_url would expire, just go to
<code>/api/deposits/{deposit_pl}/items/{item_pk}/</code> and grab a new one. Or you can get
all items from <code>/api/deposits/{deposit_pk}/</code> at once.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>After you uploaded all your files to NCBI's S3 storage bucket you have to
commit your deposit for processing by sending an HTTP <code>PUT</code> request to
<code>/api/deposits/{deposit_pk}/commit/</code> endpoint.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>To speedup the processing of your deposit you can send HTTP 'PUT' request at
the following endpoint <code>/api/deposits/{deposit_pk}/items/{item_pk}/uploaded</code>
after each successfully uploaded file to NCBI's S3 storage bucket.</p>
</div>
<h3 id="mixed-items">Mixed items<a class="headerlink" href="#mixed-items" title="Permanent link">&para;</a></h3>
<p>This case should not be typical, but it still can be used. You can basically
follow the <a href="#file-items">File Items</a> model above with exception to items
supplied as URL for those see <a href="#url-items">URL Items</a>.</p>
<div class="highlight"><pre><span></span><code>{
  items: [
    $item, $item, ...
  ],
  *depositor*: string,
  *domain*: string
}
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>After you uploaded all your files to NCBI's S3 storage bucket you have to
commit your deposit for processing by sending an HTTP <code>PUT</code> request to
<code>/api/deposits/{deposit_pk}/commit/</code> endpoint.</p>
</div>
<h3 id="no-items">No items<a class="headerlink" href="#no-items" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This model of depositing your article for conversion is also possible,
but it would take more requests/response cycles.</p>
</div>
<div class="highlight"><pre><span></span><code>{
  *depositor*: string,
  *domain*: string
}
</code></pre></div>
<p>After a deposit was successfully created you have to create your item(s),
follow the section <a href="#item">Item creation</a></p>
<h3 id="deposit-commit">Deposit commit<a class="headerlink" href="#deposit-commit" title="Permanent link">&para;</a></h3>
<p>If your items are all URLs the <code>action</code> property could be used
with value <code>commit</code> at the time of <a href="#deposit">deposit creation</a>
(see above) to save you an extra request not to be made.</p>
<p>But otherwise, you can commit your deposit to conversion (when all items
are made available).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code>PUT</code> <code>/api/deposits/{deposit_pk}/commit/</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a href="2README-API-USE-EXAMPLES.html#commit-a-deposit">Here is an example</a> of committing
a deposit for conversion.
commit-a-deposit</p>
</div>
<h3 id="deposit-state-monitoring">Deposit state monitoring<a class="headerlink" href="#deposit-state-monitoring" title="Permanent link">&para;</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code>GET /api/deposits/{deposit_pk}/</code></p>
</div>
<p>After successful creation of a deposit (a <code>deposit_id</code> was acquired, <code>items</code>
are uploaded where needed, and started the conversion with <code>commit</code> action)
you can start monitoring your deposit for result or error(s).</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>See details of <a href="#deposit-model">Deposit model</a>.</p>
</div>
<p>The main target of your interest is a <code>state</code> property in the <code>deposit</code>.</p>
<h4 id="state-no_result">State <code>NO_RESULT</code><a class="headerlink" href="#state-no_result" title="Permanent link">&para;</a></h4>
<p>If you see the <code>state</code> of a <code>deposit</code> with value <code>NO_RESULT</code>
you should check the value of the property <code>details</code>.
Where you can find an error encountered at the time of conversion.
In case if the error is not clear, contact PMC group.
In some cases, the error could be a temporary glitch, in such case
you can retry the conversion with <code>retry</code> action.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code>PUT</code> <code>/api/deposits/{deposit_pk}/retry/</code></p>
</div>
<h4 id="state-result_is_ready">State <code>RESULT_IS_READY</code><a class="headerlink" href="#state-result_is_ready" title="Permanent link">&para;</a></h4>
<p>When you see the value of the state as <code>RESULT_IS_READY</code>,
the next step is to search for an <code>item</code> where property <code>result</code> == <code>true</code>.
When you found it  you should grab the value of
the property <code>s3_get_url</code> of that item and use it to download
your PDF. That URL has an expiration time of 3600 seconds,
if for some reason you did not succeed in that period, just re-fetch
the deposit <code>deposit_pk</code> again and use the new value of <code>s3_get_url</code> property.</p>
<h4 id="state-expired">State <code>EXPIRED</code><a class="headerlink" href="#state-expired" title="Permanent link">&para;</a></h4>
<p>If you see the <code>state</code> of a <code>deposit</code> with value <code>EXPIRED</code>
than there is nothing you can do with this deposit,
even if a result was created at some point.
Objects stored in the S3 bucket have an expiration time,
therefore the deposits have it too.
But you can create a new deposit if necessary.</p>
<h4 id="state-waiting_for_upload">State <code>WAITING_FOR_UPLOAD</code><a class="headerlink" href="#state-waiting_for_upload" title="Permanent link">&para;</a></h4>
<p>This state is usually assigned for newly created deposit with <code>FILE</code> items.
It is assigned when you <code>reopen</code> the deposit to add new items if needed.
And finally, it could be assigned by <code>jats2pdf-back-office</code> component when
a deposit was committed but for some reason not all <code>FILE</code> items are available.
In this case check <code>details</code> property value for possible Exception at the time of checking.</p>
<h3 id="deposit-states-diagram">Deposit states diagram<a class="headerlink" href="#deposit-states-diagram" title="Permanent link">&para;</a></h3>
<p>The state of the deposit is available in <code>state</code> property of each deposit.
You can check all the supported states in the following deposit states diagram
(in svg format):</p>
<p><img alt="Deposit states diagram" src="fsm_diagrams/deposit_fsm.svg" title="Deposit states diagram" /></p>
<p>and applicable actions to each state as the following endpoint
<code>/api/deposits/{deposit_pk}/{action}/</code>, which could be applied
with HTTP <code>PUT</code> request.</p>
<h3 id="deposit-is-ready">Deposit is ready<a class="headerlink" href="#deposit-is-ready" title="Permanent link">&para;</a></h3>
<p>When the <code>state</code> of the deposit would become <code>RESULT_IS_READY</code> you can
look into the <code>items</code> property and iterate over to find the one with
property <code>result</code> and value <code>true</code>. There must be a <code>s3_get_url</code> property,
which you can use to download your PDF file from NCBI's S3 storage
bucket (using HTTP <code>GET</code> method).</p>
<h3 id="conversion-failed">Conversion failed<a class="headerlink" href="#conversion-failed" title="Permanent link">&para;</a></h3>
<p>When the <code>state</code> property value of the <code>deposit</code> would become <code>NO_RESULT</code>
you may find the details of that state in <code>details</code> property.</p>
<h2 id="item">Item<a class="headerlink" href="#item" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Create</p>
<p><code>POST /api/deposits/{deposit_pk}/items/</code></p>
</div>
<p>To create an item you should create a deposit first and acquire a <code>deposit_id</code>.
After that you can create your item(s) by sending <code>POST</code> HTTP request
(as many as the number of items)
to the following endpoint <code>/api/deposita/{deposit_pk}/items</code>
to create each <code>item</code>.</p>
<h3 id="item-model">Item model<a class="headerlink" href="#item-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>{
  result: boolean,
  *item*: string,
  *item_size*: integer,
  *depositor*: string,
  #created#: iso-8601-time-date-string,
  #updated#: iso-8601-time-date-string,
  #s3_head_url#: string,
  #s3_get_url#: string,
  #s3_put_url#: string,
  #item_type#: string,
  #item_id#: string,
  #state#: string,
}
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Properties in the model above, enclosed into <code>*</code> (asterisks) are mandatory,
enclosed into <code>#</code> are read-only and should be in your requests.</p>
</div>
<div class="admonition detail">
<p class="admonition-title">Detail</p>
<ul>
<li><code>result</code> - a boolean property, which indicates, that the item is the result of a conversion.</li>
<li><code>item</code> - a string which represents/holds a file name or URL of <strong>deposit</strong>.</li>
<li><code>item_size</code> - a size of the item/file in bytes. Current limits are 10Mibs for regular items and 50Mib for result items.</li>
<li><code>depositor</code> - an abbreviation of the depositor.</li>
<li><code>created</code> - the time of creation of the item.</li>
<li><code>updated</code> - time of the last update of the item.</li>
<li><code>s3_put_url</code> - property is applicable
when depositor intention was to deposit file to Amazon S3 storage
controlled by NCBI. The value of this property (URL)
will be regenerated with a new expiration time, every time,
when depositor access a deposit with "deposit_pk"
or item with "item_pk". It will not be present
if the depositor provided a retrievable URL.
<strong>s3_put_url</strong> value is suitable to be used
with method PUT when the file suppose to be uploaded to
Amazon S3 storage.</li>
<li><code>s3_get_url</code> - populated with retrievable URL if
it was provided by the depositor or with signed URL
if depositor uploaded a file to Amazon S3 storage.
This URL is suitable to be used with method GET when the file is uploaded to
Amazon S3 storage (<strong>s3_get_url</strong> is needed for <strong>jats2pdf-back-office</strong> back-end
service).</li>
<li><code>s3_head_url</code> - populated with URL of a item/file uploaded
to Amazon S3 storage.
This URL is suitable to be used with method HEAD when the file is uploaded to
Amazon S3 storage (<strong>s3_get_url</strong> is needed for <strong>jats2pdf-back-office</strong> back-end
service).</li>
<li><code>item_type</code> - <strong>FILE</strong> or <strong>URL</strong></li>
<li><code>item_id</code> - an item unique identifier.</li>
<li><code>state</code> - - <code>state</code> - a machine-readable item state,
see <a href="#item-states-diagram">diagram</a>.</li>
</ul>
</div>
<h3 id="item-states-diagram">Item states diagram<a class="headerlink" href="#item-states-diagram" title="Permanent link">&para;</a></h3>
<p>The state of the deposit is available in <code>state</code> property of each deposit.
You can check all the supported states
in the following deposit states diagram (in svg format):</p>
<p><img alt="Item states diagram" src="fsm_diagrams/item_fsm.svg" title="Deposit states diagram" /></p>
<p>and applicable actions to each state as the following endpoint
<code>/api/deposits/{deposit_pk}/items/{item_pk}/{action}/</code>, which could be applied
with HTTP <code>PUT</code> request.</p>
<h2 id="auto-generated-diagram">Auto-generated diagram<a class="headerlink" href="#auto-generated-diagram" title="Permanent link">&para;</a></h2>
<p>Auto-generated states diagram (in svg format):</p>
<p><img alt="Autogenerated diagram" src="fsm_diagrams/django_fsm_diagram.svg" title="Autogenerated diagram" /></p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="0README.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
        
        <a href="2README-API-USE-EXAMPLES.html" class="md-footer__link md-footer__link--next" aria-label="Next: Use examples" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Use examples
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js", "version": "0.3.4"}</script>
    
    
      <script src="assets/javascripts/bundle.1514a9a0.min.js"></script>
      
    
  </body>
</html>